!function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("elliptical-platform")):"function"==typeof define&&define.amd?define(["elliptical-platform"],t):e.returnExports=t($)}(this,function(e){var t=e.elliptical.utils,o=t._;return e.elliptical.hasObjectObserve||e.elliptical.startDirtyCheck(),e.element("elliptical.scope",{options:{idProp:"id",dataBind:!0},_initElement:function(){this._data._timeOutId=null,this._data.scopeObserver=null,this._data.scopeId=this.options.idProp,this._data._discard=!1,this.__initScope(),this.options.dataBind&&this.__initScopeObservable()},__initScope:function(){this.$scope={}},__initScopeObservable:function(){var e=this;this._data._timeOutId=setInterval(function(){o.isEmpty(e.$scope)||(clearInterval(e._data._timeOutId),e.__setObservable(),e._onScopeInit(e.__cloneScope()))},500)},__setObservable:function(){var e=this.$scope,t=this,o=this.options.idProp;void 0===o&&(o="id");var i=new ObjectObserver(e,o);i.open(function(e){t.__onScopeChange(e)}),this._data.scopeObserver=i},__destroyObservable:function(){this._data.scopeObserver&&(this._data.scopeObserver.close(),this._data.scopeObserver=null,this.$scope=null)},__resetObservable:function(){this.__destroyObservable(),this.__setObservable()},__cloneScope:function(){return o.cloneDeep(this.$scope)},__cloneObject:function(e){return o.cloneDeep(e)},__scopeLength:function(e){var o="undefined"==typeof e?this.$scope:e;if(t.isPropertyByIndexArray(o,0)){var i=t.objectPropertyByIndex(o,0);return i.length}return-1},__isModelList:function(){return this.__scopeLength()>-1},_removeFromModelListById:function(e){var o=this.$scope,i=this._data.scopeId;t.deleteObjectByIdFromArrayProp(o,i,e)},_selectFromModelListById:function(e){var o=this.$scope,i=this._data.scopeId;return void 0===i&&(i="id"),t.selectObjectByIdFromArrayProp(o,i,e)},_selectFromModelListByObj:function(e){var t,i=this.$scope[Object.keys(this._scope)[0]];return i.forEach(function(i){o.isEqual(e,i)&&(t=i)}),t},_scopeIndexById:function(e){var o=this._data.scopeId;return void 0===o&&(o="id"),t.objectIndexById(this.$scope,e,o)},__recycle:function(){this.__destroyObservable(),this.__setObservable()},__clearWatch:function(){this._data.timeOutId&&clearInterval(self._data._timeOutId)},__onScopeChange:function(e){this._data._discard||this._onScopeChange(e)},__printScope:function(e){void 0===e&&(e=0);var t=this;setTimeout(function(){console.log(t.$scope)},e)},_objectChange:function(e){if(e.object&&e.oldObject)return t.objChangedProps(e.object,e.oldObject);var o={};return o[e.name]=e.value,o},_dispose:function(){this.__clearWatch(),this.__destroyObservable()},_onScopeInit:e.noop,_onScopeChange:e.noop,$changeReport:function(e,o){return t.objChangedProps(e,o)}}),e});